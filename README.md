# Healthcare Operations Analysis in SQL (BigQuery)
An advanced SQL portfolio on Google BigQuery analyzing a healthcare database. Demonstrates Window Functions, CTEs, & Subqueries to solve business problems like physician revenue & aged receivables. Also features CASE statements, multi-table JOINs, & COALESCE for data cleaning & business logic.

## Project Objective
The goal of this project was to act as a Data Analyst for a hospital. I analyzed a multi-table relational database to identify key drivers of revenue, track billing efficiency, and understand patient-doctor interactions.

## The Dataset
The raw data for this project was sourced from the "Hospital Management Dataset" on Kaggle.

*   **Source:** https://www.kaggle.com/datasets/kanakbaghel/hospital-management-dataset
*   **Process:** I personally uploaded the CSV files to a private project in Google BigQuery, established the table relationships, and used BigQuery's SQL engine for all analysis.

## Comprehensive Database Schema
This analysis was performed on a multi-table relational database structure, utilizing the following five tables:

## 3. Database Schema

This analysis was performed on a multi-table relational database structure, utilizing the following five tables:

### Table: `patients` (Demographic Data)

| Column Name | Data Type (BigQuery) | Description |
| :--- | :--- | :--- |
| **`patient_id`** | `STRING` | **Primary Key (PK)**. Unique identifier for each patient. |
| `first_name` | `STRING` | Patient's first name. |
| `last_name` | `STRING` | Patient's last name. |
| `date_of_birth` | `DATE` | Patient's birth date. Used for age calculations. |
| `gender` | `STRING` | Biological gender (e.g., 'Male', 'Female', 'Other'). |
| `zip_code` | `STRING` | Patient's geographical location (used for regional analysis). |

### Table: `doctors` (Provider Data)

| Column Name | Data Type (BigQuery) | Description |
| :--- | :--- | :--- |
| **`doctor_id`** | `STRING` | **Primary Key (PK)**. Unique identifier for each doctor. |
| `first_name` | `STRING` | Doctor's first name. |
| `last_name` | `STRING` | Doctor's last name. |
| `specialization` | `STRING` | Medical field of expertise (e.g., 'Orthopedics', 'Cardiology'). |
| `years_of_experience` | `INT64` | Doctor's tenure/experience level. |

### Table: `appointments` (Operational/Scheduling Data)

| Column Name | Data Type (BigQuery) | Description |
| :--- | :--- | :--- |
| **`appointment_id`** | `STRING` | **Primary Key (PK)**. Unique identifier for the appointment record. |
| **`patient_id`** | `STRING` | **Foreign Key (FK)**. Links to the `patients` table. |
| **`doctor_id`** | `STRING` | **Foreign Key (FK)**. Links to the `doctors` table. |
| `appointment_date` | `TIMESTAMP` | The scheduled date and time of the appointment. |
| `status` | `STRING` | Appointment result (e.g., 'Completed', **'No-Show'**, 'Canceled'). |
| `wait_time_minutes` | `INT64` | Time patient waited (used for efficiency metrics). |

### Table: `treatments` (Clinical/Procedure Data)

| Column Name | Data Type (BigQuery) | Description |
| :--- | :--- | :--- |
| **`treatment_id`** | `STRING` | **Primary Key (PK)**. Unique identifier for the treatment performed. |
| **`appointment_id`** | `STRING` | **Foreign Key (FK)**. Links back to the `appointments` table. |
| `procedure_code` | `STRING` | Standard medical code (e.g., CPT/HCPCS) for the treatment. |
| `treatment_description` | `STRING` | Plain text description of the service rendered. |
| `duration_minutes` | `INT64` | Length of the procedure (used for cost/revenue weighting). |

### Table: `billing` (Financial Data)

| Column Name | Data Type (BigQuery) | Description |
| :--- | :--- | :--- |
| **`bill_id`** | `STRING` | **Primary Key (PK)**. Unique identifier for the bill. |
| **`treatment_id`** | `STRING` | **Foreign Key (FK)**. Links to the specific treatment performed. |
| `amount_due` | `FLOAT64` | Total amount charged for the service. |
| `payment_status` | `STRING` | Current status (e.g., 'Paid', 'Pending', **'Aged Receivables'**). |
| `billing_date` | `DATE` | The date the bill was generated. |
| `due_date` | `DATE` | The date payment is expected. |

## Key Analyses & Insights

### Analysis 1: Physician Revenue Performance

*   **Business Question:** Which doctors and specializations drive the highest total billed revenue, and how does this information inform resource allocation and financial forecasting for the hospital?
*   **My SQL Query:**
 ```sql
-- Objective: Calculate the total billed revenue generated by each doctor, 
-- including doctors who have not generated any revenue (using LEFT JOIN).
SELECT 
    d.doctor_id, 
    d.first_name, 
    d.last_name, 
    d.specialization,
    -- Use COALESCE to display 0.0 instead of NULL for doctors with no revenue
    COALESCE(SUM(b.amount), 0.0) AS Total_billed_Revenue
FROM 
    `bio_analytics.doctors` AS d
-- 1. Link doctors to appointments
LEFT JOIN 
    `bio_analytics.appointments` AS a
    ON d.doctor_id = a.doctor_id
-- 2. Link appointments to treatments performed
LEFT JOIN
    `bio_analytics.treatments` AS t
    ON a.appointment_id = t.appointment_id
-- 3. Link treatments to billing records (CORRECTED JOIN KEY: treatment_id)
LEFT JOIN
    `bio_analytics.billing` AS b
    ON t.treatment_id = b.treatment_id
GROUP BY
    d.doctor_id,
    d.first_name,
    d.last_name,
    d.specialization
ORDER BY
    Total_Billed_Revenue DESC;
```
*   **Results & Insight:** This query generates the foundation for the hospital's financial performance reports. By calculating the Total_Billed_Revenue and ordering the results, we can immediately identify high-impact specialties and individual top earners (e.g., if Dermatology generates 40% of revenue, management should prioritize its resources). The use of LEFT JOIN ensures that doctors who have yet to generate revenue (e.g., new hires) are still included in the report with a NULL or zero revenue value, providing a complete picture for management rather than just showing active accounts.

    ![Physician Revenue Performance Results in BigQuery](images/physician_revenue_performance.png)

### Analysis 2: Patient Lifetime Cost & Utilization

*   **Business Question:** What are the top 5 highest-cost patients by cumulative billed treatments, and how can this metric be used to identify high-utilization patients for targeted case management or risk stratification?

*   **My SQL Query:**
```SQL

-- Objective: Calculate the total lifetime billed cost for every patient, 
-- limited to the top 5 for reporting purposes.
SELECT
    p.first_name,
    p.last_name,
    p.patient_id,
    -- Using b.amount as the billed financial value
    COALESCE(SUM(b.amount), 0.0) AS Total_Cost_for_Treatments
FROM 
    `bio_analytics.patients` AS p
-- 1. Link patient to appointments
LEFT JOIN
    `bio_analytics.appointments` AS a
    ON p.patient_id = a.patient_id
-- 2. Link appointment to treatment
LEFT JOIN
    `bio_analytics.treatments` AS t
    ON a.appointment_id = t.appointment_id
-- 3. Link treatment to billing (where the cost data is)
LEFT JOIN
    `bio_analytics.billing` AS b
    ON t.treatment_id = b.treatment_id
GROUP BY
    p.patient_id,
    p.first_name,
    p.last_name
ORDER BY
    Total_Cost_for_Treatments DESC
LIMIT 5; 
```
Results & Insight: This query successfully identifies the Top 5 highest-cost patients, providing management with an immediate list for risk analysis. This cohort often represents patients with complex or chronic care needs, and these costs directly impact the hospital's budget. The query demonstrates the ability to join four tables correctly, aggregate data using SUM(), and use the LIMIT clause for professional, summarized reporting. This is a foundational step for implementing cost-reduction strategies like disease management or preventative care programs.
    
![Patient Lifetime Cost & Utilization Results in BigQuery](images/patient_billing_amount.png)
