# Healthcare Operations Analysis in SQL (BigQuery)
An advanced SQL portfolio on Google BigQuery analyzing a healthcare database. Demonstrates Window Functions, CTEs, & Subqueries to solve business problems like physician revenue & aged receivables. Also features CASE statements, multi-table JOINs, & COALESCE for data cleaning & business logic.

## Project Objective
The goal of this project was to act as a Data Analyst for a hospital. I analyzed a multi-table relational database to identify key drivers of revenue, track billing efficiency, and understand patient-doctor interactions.

## The Dataset
The raw data for this project was sourced from the "Hospital Management Dataset" on Kaggle.

*   **Source:** https://www.kaggle.com/datasets/kanakbaghel/hospital-management-dataset
*   **Process:** I personally uploaded the CSV files to a private project in Google BigQuery, established the table relationships, and used BigQuery's SQL engine for all analysis.

## Comprehensive Database Schema
This analysis was performed on a multi-table relational database structure, utilizing the following five tables:

## 3. Database Schema

This analysis was performed on a multi-table relational database structure, utilizing the following five tables:

### Table: `Patients` (Demographic and Contact Data)

| Field Name | Type | Description |
| :--- | :--- | :--- |
| **`patient_id`** | `STRING` | **Primary Key (PK)**. Unique patient identifier. |
| `first_name` | `STRING` | Patient's first name. |
| `last_name` | `STRING` | Patient's last name. |
| `gender` | `STRING` | Biological gender. |
| `date_of_birth` | `DATE` | Patient's date of birth (used for age analysis). |
| `contact_number` | `INTEGER` | Patient's primary phone number. |
| `address` | `STRING` | Patient's physical address. |
| `registration_date` | `DATE` | Date the patient first registered. |
| `insurance_provider` | `STRING` | Patient's primary health insurance carrier. |
| `insurance_number` | `STRING` | Patient's insurance policy identifier. |
| `email` | `STRING` | Patient's email address. |

### Table: `Doctors` (Provider Data)

| Field Name | Type | Description |
| :--- | :--- | :--- |
| **`doctor_id`** | `STRING` | **Primary Key (PK)**. Unique doctor identifier. |
| `first_name` | `STRING` | Doctor's first name. |
| `last_name` | `STRING` | Doctor's last name. |
| `specialization` | `STRING` | Medical field of expertise (e.g., 'Cardiology'). |
| `phone_number` | `INTEGER` | Doctor's contact number. |
| `years_experience` | `INTEGER` | Doctor's professional experience tenure. |
| `hospital_branch` | `STRING` | Hospital branch where the doctor practices. |
| `email` | `STRING` | Doctor's email address. |

### Table: `Appointments` (Scheduling Data)

| Field Name | Type | Description |
| :--- | :--- | :--- |
| **`appointment_id`** | `STRING` | **Primary Key (PK)**. Unique appointment identifier. |
| **`patient_id`** | `STRING` | **Foreign Key (FK)**. Links to the `Patients` table. |
| **`doctor_id`** | `STRING` | **Foreign Key (FK)**. Links to the `Doctors` table. |
| `appointment_date` | `DATE` | Scheduled date of the appointment. |
| `appointment_time` | `TIME` | Scheduled time of the appointment. |
| `reason_for_visit` | `STRING` | Patient's stated reason for seeking care. |
| `status` | `STRING` | Outcome (e.g., 'Completed', 'No-Show', 'Canceled'). |

### Table: `Treatments` (Clinical Procedure and Cost Data)

| Field Name | Type | Description |
| :--- | :--- | :--- |
| **`treatment_id`** | `STRING` | **Primary Key (PK)**. Unique treatment identifier. |
| **`appointment_id`** | `STRING` | **Foreign Key (FK)**. Links to the `Appointments` table. |
| `treatment_type` | `STRING` | Categorization of the procedure (e.g., 'Surgery'). |
| `description` | `STRING` | Detailed description of the service rendered. |
| `cost` | `FLOAT` | **Direct cost of the treatment.** |
| `treatment_date` | `DATE` | **Date the treatment was administered.** |

### Table: `Billing` (Financial Transactions)

| Field Name | Type | Description |
| :--- | :--- | :--- |
| **`bill_id`** | `STRING` | **Primary Key (PK)**. Unique bill identifier. |
| **`patient_id`** | `STRING` | **Foreign Key (FK)**. Links directly to the `Patients` table. |
| **`treatment_id`** | `STRING` | **Foreign Key (FK)**. Links to the `Treatments` table. |
| `bill_date` | `DATE` | Date the bill was generated. |
| `amount` | `FLOAT` | **Amount billed to the patient.** |
| `payment_method` | `STRING` | Method of payment. |
| `payment_status` | `STRING` | Status of payment (e.g., 'Paid', 'Pending'). |

## Key Analyses & Insights

### Analysis 1: Physician Revenue Performance (Top 5)

*   **Business Question:** Which are the top 5 highest-grossing doctors by total billed revenue, and how does this ranking inform executive decisions regarding resource allocation, bonuses, and specialization investment?

*   **My SQL Query:**

```SQL

-- Objective: Calculate the total billed revenue generated by the top 5 doctors.
SELECT 
    d.doctor_id, 
    d.first_name, 
    d.last_name, 
    d.specialization,
    -- Amount is sourced from the Billing table (b.amount)
    COALESCE(SUM(b.amount), 0.0) AS Total_billed_Revenue
FROM 
    `bio_analytics.doctors` AS d
-- 1. Link doctor to appointments (via doctor_id)
LEFT JOIN 
    `bio_analytics.appointments` AS a
    ON d.doctor_id = a.doctor_id
-- 2. Link appointments to treatments (via appointment_id)
LEFT JOIN
    `bio_analytics.treatments` AS t
    ON a.appointment_id = t.appointment_id
-- 3. Link treatments to billing (via treatment_id) where the 'amount' is
LEFT JOIN
    `bio_analytics.billing` AS b
    ON t.treatment_id = b.treatment_id
GROUP BY
    d.doctor_id,
    d.first_name,
    d.last_name,
    d.specialization
ORDER BY
    Total_billed_Revenue DESC
LIMIT 5; -- Limits the result set to the top performers for concise reporting
```

*   **Results & Insight:** This query successfully identifies the Top 5 physician revenue generators, which directly informs executive strategy. The high ranking of certain specialties (e.g., Orthopedics or Cardiology) suggests where specialization investment should be focused. The individual revenue figures are used to determine performance bonuses, and this data dictates resource allocation, ensuring high-performing doctors have adequate staff and equipment to maintain productivity. The combined use of aggregation and the LIMIT clause provides concise, actionable KPI data.

BigQuery Results
